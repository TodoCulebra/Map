<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Culebra Ultimate Interactive Map 2025</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        #map { height: 100vh; }

        .top-banner {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: #b2ff59;
            padding: 10px 20px;
            border-radius: 12px;
            font-weight: bold;
            z-index: 1500;
            box-shadow: 0 6px 20px rgba(0,0,0,0.6);
        }

        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(10,42,58,0.95);
            color: white;
            padding: 12px 18px;
            border-radius: 12px;
            font-size: 0.95em;
            line-height: 1.4;
            box-shadow: 0 6px 20px rgba(0,0,0,0.7);
            z-index: 1500;
        }

        .legend a {
            color: #b2ff59;
            text-decoration: none;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin: 6px 0;
        }

        .legend a:hover {
            text-decoration: underline;
            color: #fff;
        }

        .legend-pin {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: inline-block;
        }

        .legend-pin.red    { background: #ff2d2d; }
        .legend-pin.blue   { background: #1e90ff; }
        .legend-pin.purple { background: #800080; }

        .pulse-tree {
            font-size: 40px;
            animation: pulseGlow 2s infinite;
            text-shadow: 0 0 8px #00ff00, 0 0 12px #00ff00, 0 0 16px #00ff00, 0 0 20px #00ff00;
        }

        @keyframes pulseGlow {
            0%   { transform: scale(1);   opacity: 1; }
            50%  { transform: scale(1.3); opacity: 0.7; }
            100% { transform: scale(1);   opacity: 1; }
        }
    </style>
</head>
<body>

    <div class="top-banner">Culebra Ultimate Map 2025 ‚Äì Powered by Todo Culebra</div>
    <div id="map"></div>

    <div class="legend">
        <div><a href="#" onclick="toggleCategory('beach')"><span class="legend-pin red"></span> Beaches</a></div>
        <div><a href="#" onclick="toggleCategory('snorkel')"><span class="legend-pin blue"></span> Snorkel Spots</a></div>
        <div><a href="#" onclick="toggleCategory('todo')"><span class="legend-pin purple"></span> Things to Do</a></div>
        <div><a href="#" onclick="toggleCategory('food')">Food & Drink</a></div>
        <hr style="border-color: rgba(255,255,255,0.2)">
        <div><a href="#" onclick="focusMarker(kokomoMarker)">Kokomo Plaza Hub</a></div>
        <div><a href="#" onclick="focusMarker(culebritaMarker)">Culebrita Island</a></div>
        <div><a href="#" onclick="focusMarker(luispenaMarker)">Luis Pe√±a Reserve</a></div>
        <div><a href="#" onclick="focusMarker(deweyMarker)">Dewey Town Center</a></div>
        <div><a href="#" onclick="toggleCategory('decoration')">Decorations</a></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Map initialization
        const map = L.map('map').setView([18.307, -65.305], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '¬© OpenStreetMap contributors',
            maxZoom: 20
        }).addTo(map);

        // Small blip icons (decluttered view)
        const beachBlip   = L.divIcon({ html: '<div style="background:#ff2d2d;width:8px;height:8px;border-radius:50%;"></div>', iconSize: [8,8], className: '' });
        const snorkelBlip = L.divIcon({ html: '<div style="background:#1e90ff;width:8px;height:8px;border-radius:50%;"></div>', iconSize: [8,8], className: '' });
        const todoBlip    = L.divIcon({ html: '<div style="background:#800080;width:8px;height:8px;border-radius:50%;"></div>', iconSize: [8,8], className: '' });
        const foodBlip    = L.divIcon({ html: '<div style="background:#ff7f00;width:8px;height:8px;border-radius:50%;"></div>', iconSize: [8,8], className: '' });

        // Full-size pins
        const beachPin    = L.divIcon({ html: '<div style="background:#ff2d2d;color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;">üåä</div>', iconSize: [34,34], className: '' });
        const snorkelPin  = L.divIcon({ html: '<div style="background:#1e90ff;color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;">ü§ø</div>', iconSize: [34,34], className: '' });
        const todoPinBike = L.divIcon({ html: '<div style="background:#800080;color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;">üö≤</div>', iconSize: [34,34], className: '' });
        const todoPinTree = L.divIcon({ html: '<div style="background:#800080;color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;">üéÑ</div>', iconSize: [34,34], className: '' });
        const foodPin     = L.divIcon({ html: '<div style="background:#ff7f00;color:white;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px;">üç¥</div>', iconSize: [34,34], className: '' });

        const hubIcon        = L.divIcon({ html: '<div style="font-size:28px;color:#ff7f00;">üè†</div>', iconSize:[28,28], className:'' });
        const lighthouseIcon = L.divIcon({ html: '<div style="font-size:28px;">üóº</div>', iconSize:[28,28], className:'' });
        const reserveIcon    = L.divIcon({ html: '<div style="font-size:28px;">üåø</div>', iconSize:[28,28], className:'' });
        const townIcon       = L.divIcon({ html: '<div style="font-size:28px;">üèõÔ∏è</div>', iconSize:[28,28], className:'' });

        // Markers ‚Äì Beaches
        const flamencoMarker = L.marker([18.32964, -65.31981], {icon: beachBlip}).addTo(map)
            .bindPopup('<b>Flamenco Beach</b><br>Top-10 world beach ‚Ä¢ WWII tank ‚Ä¢ $2 entry');
        const zoniMarker = L.marker([18.31983, -65.25503], {icon: beachBlip}).addTo(map)
            .bindPopup('<b>Zoni Beach</b><br>Secluded ‚Ä¢ Turtle nesting ‚Ä¢ Steep road (e-bikes only)');
        const tamarindoMarker = L.marker([18.31775, -65.31758], {icon: beachBlip}).addTo(map)
            .bindPopup('<b>Tamarindo Beach</b><br>Calm bay ‚Ä¢ Rays & turtles ‚Ä¢ Great snorkeling');
        const datilesMarker = L.marker([18.29669, -65.30042], {icon: beachBlip}).addTo(map)
            .bindPopup('<b>Datiles Beach</b><br>Quiet local spot');

        // Snorkel spots
        const melonesMarker = L.marker([18.303182, -65.310238], {icon: snorkelBlip}).addTo(map)
            .bindPopup('<b>Playa Melones</b><br>Excellent snorkeling, turtles, calm waters<br><a href="https://snorkelwithlocals.com/melones" target="_blank" rel="noopener">More info</a>');
        const carlosMarker = L.marker([18.32442, -65.32986], {icon: snorkelBlip}).addTo(map)
            .bindPopup('<b>Carlos Rosario Beach</b><br>Best offshore reef on Culebra<br><a href="https://snorkelwithlocals.com/carlosrosario" target="_blank" rel="noopener">More info</a>');
        const soldadoMarker = L.marker([18.28164, -65.28678], {icon: snorkelBlip}).addTo(map)
            .bindPopup('<b>Punta Soldado</b><br>Excellent for scuba, free diving, snorkeling & spearfishing.<br><a href="https://todoculebra.com" target="_blank" rel="noopener">todoculebra.com</a>');

        // Todo / Special
        const ebikeMarker = L.marker([18.309611, -65.303778], {icon: todoPinBike}).addTo(map)
            .bindPopup('<b>Todo Culebra E-Bikes</b><br><a href="https://todoculebra.com" target="_blank">todoculebra.com</a>');
        const treeMarker = L.marker([18.311861, -65.298806], {icon: L.divIcon({html: '<div class="pulse-tree">üéÑ</div>', iconSize:[40,40], className:''})}).addTo(map)
            .bindPopup('<b>Christmas Tree üéÑ</b><br>Seasonal lights, go see them at night today!');
        const sunsetSpotMarker = L.marker([18.29928, -65.30006], {icon: todoBlip}).addTo(map)
            .bindPopup('<b>Sunset Spot üåÖ</b><br>E-Bike & Golf Kart friendly. Arrive ~5:15pm!');

        // Landmarks
        const kokomoMarker = L.marker([18.30120, -65.30213], {icon: hubIcon}).addTo(map).bindPopup(
            '<div style="text-align:center;font-weight:bold;">KOKOMO PLAZA HUB</div>' +
            '<ul style="list-style:none;padding:0;margin:8px 0;text-align:left;">' +
            '<li><a href="https://sandbarculebra.com" target="_blank" rel="noopener">Sandbar</a></li>' +
            '<li><a href="https://kokomohotel.com" target="_blank" rel="noopener">Kokomo Hotel</a></li>' +
            '<li><a href="https://ledelibleu.com" target="_blank" rel="noopener">Le Deli Bleu</a></li>' +
            '<li><a href="https://bluewaterculebra.com" target="_blank" rel="noopener">Bluewater</a></li>' +
            '<li><a href="https://ferrytoculebra.com" target="_blank" rel="noopener">Culebra Ferry</a></li>' +
            '</ul>'
        );

        const culebritaMarker = L.marker([18.3160, -65.2230], {icon: lighthouseIcon}).addTo(map)
            .bindPopup('<b>Culebrita Island</b><br>Lighthouse ruins ‚Ä¢ Natural jacuzzis ‚Ä¢ Pristine beaches');
        const luispenaMarker = L.marker([18.3100, -65.3300], {icon: reserveIcon}).addTo(map)
            .bindPopup('<b>Luis Pe√±a Nature Reserve</b><br>Protected marine area ‚Ä¢ Kayaking ‚Ä¢ Hiking');
        const deweyMarker = L.marker([18.3010, -65.3010], {icon: townIcon}).addTo(map)
            .bindPopup('<b>Dewey (Culebra Pueblo)</b><br>Ferry dock ‚Ä¢ Restaurants ‚Ä¢ Shops ‚Ä¢ Dinghy Dock');

        // Food & Drink
        const foodMarkers = [
            L.marker([18.3083496, -65.3036156], {icon: foodBlip}).addTo(map).bindPopup('<b>Blac Flamingo Coffee</b>'),
            L.marker([18.3031875, -65.3003125], {icon: foodBlip}).addTo(map).bindPopup('<b>Zaco\'s Tacos</b>'),
            L.marker([18.3031122, -65.2999219], {icon: foodBlip}).addTo(map).bindPopup('<b>El Navegante de Culebra</b>'),
            L.marker([18.3022135, -65.2993188], {icon: foodBlip}).addTo(map).bindPopup('<b>Dinghy Dock Restaurant</b>'),
            L.marker([18.3013238, -65.3021362], {icon: foodBlip}).addTo(map).bindPopup('<b>Kokomo Caf√©</b>'),
            // ‚Ä¶ (all the rest of your food markers stay exactly the same)
        ];

        // Category system
        const categories = {
            beach: [
                { marker: flamencoMarker, blip: beachBlip, pin: beachPin },
                { marker: zoniMarker, blip: beachBlip, pin: beachPin },
                { marker: tamarindoMarker, blip: beachBlip, pin: beachPin },
                { marker: datilesMarker, blip: beachBlip, pin: beachPin }
            ],
            snorkel: [
                { marker: melonesMarker, blip: snorkelBlip, pin: snorkelPin },
                { marker: carlosMarker, blip: snorkelBlip, pin: snorkelPin },
                { marker: soldadoMarker, blip: snorkelBlip, pin: snorkelPin }
            ],
            todo: [
                { marker: ebikeMarker, blip: todoBlip, pin: todoPinBike },
                { marker: sunsetSpotMarker, blip: todoBlip, pin: todoPinBike }
            ],
            decoration: [
                { marker: treeMarker, blip: todoBlip, pin: todoPinTree }
            ],
            food: foodMarkers.map(m => ({ marker: m, blip: foodBlip, pin: foodPin }))
        };

        function setIcon(entry, toPin) {
            entry.marker.setIcon(toPin ? entry.pin : entry.blip);
        }

        function toggleCategory(cat) {
            const group = categories[cat];
            if (!group) return;
            group.forEach(entry => {
                const isBlip = entry.marker.options.icon === entry.blip;
                setIcon(entry, isBlip); // toggle blip ‚Üî pin
            });
        }

        function enableIndividualToggle(entry) {
            entry.marker.on('click', () => {
                const isBlip = entry.marker.options.icon === entry.blip;
                setIcon(entry, isBlip);
                entry.marker.openPopup();
            });
        }

        Object.values(categories).flat().forEach(enableIndividualToggle);

        function focusMarker(marker) {
            map.setView(marker.getLatLng(), 16, {animate: true});
            marker.openPopup();
        }
    </script>
</body>
</html>